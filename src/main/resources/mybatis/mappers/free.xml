<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
                        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
                        
<mapper namespace="com.kosta.clothes.dao.FreeDAO">
<!-- 글쓰기 등록  -->
	<insert id="insertFree" parameterType="Free">
		<selectKey keyProperty="fno" resultType="Integer" order="BEFORE">
			<![CDATA[
				select free_seq.nextval from dual
			]]>
		</selectKey>
		<![CDATA[
			insert into free (fno,
							   fname, 
							   ftitle, 
							   fcontent, 
						 	   freadcount,
						 	   regdate,
						 	   userno,
						 	   bno)
			values(#{fno},
				   #{fname},
				   #{ftitle,jdbcType=VARCHAR},
				   #{fcontent,jdbcType=VARCHAR},
				   #{freadcount},
				   sysdate,
				   #{userno,jdbcType=INTEGER},
				   #{bno,jdbcType=INTEGER})
		]]>
				

	</insert>
	<!-- 최신 글 등록 번호 가져오기 -->
	<select id="selectMaxFreeNum" resultType="Integer">
		<![CDATA[
			select max(fno) from free
		]]>
	</select>
	
	<!-- 글 목록 보여주기 -->
	<select id="selectFreeList" resultType="Free" parameterType="Integer">
		<![CDATA[
			select fno,fname,ftitle,fcontent,freadcount,regdate,userno,bno
			from (select row_number() over (order by regdate desc) num, F.*
					from FREE F)	
			where fno between #{row} AND #{row}+9
					]]>
	</select>
	
	<!-- 실제 글 전체 개수 -->
	<select id="selectFreeCount" resultType="Integer">
		<![CDATA[
			select count(*) from free
		]]>
	</select>
	
	<!-- 글 클릭 시 정보 가져가기 -->
	<select id="selectFree" resultType="Free" parameterType="Integer">
		<![CDATA[
			select * from free where fno=#{fno}
		]]>
	</select>
	
	<!-- 글 수정  -->
	<update id="updatefree"  parameterType="Free">
		<![CDATA[
			update free
			set ftitle=#{ftitle}, fcontent=#{fcontent}
			where fno=#{fno}
		]]>
	</update>
	
	
	<!-- 글 삭제하기 -->
	<delete id="deletefree" parameterType="Integer">
		<![CDATA[
			delete from free where fno=#{fno}
		]]>
	</delete>
</mapper>